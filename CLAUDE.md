# CLAUDE.md

## 目的
Claude Code の作業方針とプロジェクト固有ルールを示します。

## 判断記録のルール
1. 判断内容の要約を記載する
2. 検討した代替案を列挙する
3. 採用しなかった案とその理由を明記する
4. 前提条件・仮定・不確実性を明示する
5. 他エージェントによるレビュー可否を示す

## プロジェクト概要
- 目的: Steam のウィッシュリストをチェックし、割引情報を Discord で通知する
- 主な機能: ウィッシュリスト取得、割引フィルタリング、SteamDB 最安値取得、Discord 通知

## 重要ルール
- 会話言語: 日本語
- コミット規約: Conventional Commits ([type]: [description]) ※description は日本語
- コメント言語: 日本語
- エラーメッセージ言語: 英語

## 環境のルール
- ブランチ命名: Conventional Branch ([type]/[description]) ※type は短縮形（feat, fix）
- GitHub リポジトリ調査: テンポラリディレクトリに clone して検索
- Renovate PR: 追加コミットや更新は行わない

## コード改修時のルール
- 日本語と英数字の間に半角スペースを挿入する
- エラーメッセージの絵文字を全体で統一する
- TypeScript の `skipLibCheck` は使用禁止
- 関数やインターフェースには日本語で JSDoc を記載する

## 相談ルール
- Codex CLI: 実装レビュー、局所設計、整合性確認
- Gemini CLI: 外部仕様、最新情報確認
- 指摘への対応: 信頼度 50 以上の指摘には必ず対応する

## 開発コマンド
```bash
# 依存関係のインストール
pnpm install

# 実行
pnpm start

# 開発
pnpm dev

# Lint
pnpm lint

# 自動修正
pnpm fix

# スキーマ生成
pnpm generate-schema
```

## アーキテクチャと主要ファイル
### アーキテクチャサマリー
Node.js 上で動作する TypeScript スクリプト。`axios` で Steam API を叩き、`puppeteer-core` で SteamDB からスクレイピングを行う。

### 主要ディレクトリ
- `src/`: ソースコード
- `schema/`: 設定ファイルの JSON スキーマ
- `data/`: 実行時に使用されるデータディレクトリ（Git 管理外）

## 実装パターン
- 推奨: `@book000/node-utils` のユーティリティ（Logger, Discord, ConfigFramework）を活用する。
- 非推奨: 大規模なスクレイピング（SteamDB への負荷を考慮）。

## テスト
- テスト方針: 現時点ではテストなし。

## 作業チェックリスト
### 新規改修時
1. プロジェクトを理解する
2. 作業ブランチが適切であることを確認する
3. 最新のリモートブランチに基づいた新規ブランチであることを確認する
4. 不要ブランチが削除済みであることを確認する
5. pnpm で依存関係をインストールする

### コミット・プッシュ前
1. Conventional Commits に従っていることを確認する
2. センシティブな情報が含まれていないことを確認する
3. `pnpm lint` でエラーがないことを確認する
4. 動作確認を行う

### PR 作成前
1. PR 作成の依頼があることを確認する
2. コンフリクトの恐れがないことを確認する

### PR 作成後
1. コンフリクトがないことを確認する
2. PR 本文が最新状態のみを網羅していることを確認する
3. `gh pr checks <PR ID> --watch` で CI を確認する
4. Copilot レビュー、Codex レビューに対応する
